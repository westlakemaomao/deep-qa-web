<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<!--
<sqlMap>
	<typeAlias alias="UserEntity" type="com.deepQAWeb.domain.User" />
	<resultMap id="userMap" class="UserEntity">
			<result property="id" column="ID" />
			<result property="username" column="USERNAME" />
			<result property="password" column="PASSWORD" />
			<result property="email" column="EMAIL" />
			<result property="status" column="status" />
			<result property="isMailReciever" column="isMailReciever" />
			<result property="comments" column="comments" />
			<result property="name" column="name" />				
	</resultMap>
	
	<select id="getUserList" resultMap="userMap">
		SELECT 
			ID,
			USERNAME,
			PASSWORD,
			EMAIL,
		 	status,
		 	isMailReciever,
		 	comments,
		 	name
		FROM 
			user
		where status='ACT'
	</select>	
	
	<select id="getUserListCount" resultClass="long">
		SELECT count(1) FROM user where status='ACT'
	</select>
	
	<select id="getUserByName" resultMap="userMap" parameterClass="java.lang.String">
		SELECT 
			id,
			username,
			password,
			email,
		 	status,
		 	isMailReciever,
		 	comments,
		 	name
		FROM 
			user 
		WHERE 
			username=#username#
		and status='ACT';
	</select>
	
	<insert id="insertUser" parameterClass="UserEntity">
		INSERT INTO user (username,password,email,status,isMailReciever,comments,name) 
		VALUES (#username#,#password#,#email#,#status#,#isMailReciever#,#comments#,#name#)
		<selectKey resultClass="int" keyProperty="id"> 
               SELECT @@IDENTITY AS id 
         </selectKey> 
	</insert>
	<update id="updateUser"  parameterClass="UserEntity">
	    	UPDATE user
		SET  
		  email=#email#,
		  isMailReciever=#isMailReciever#,
		  comments=#comments#,
		  name=#name#
		WHERE username = #username#
	</update>
	<update id="updateUserAccountPsw"  parameterClass="UserEntity">
	    	UPDATE user
		SET  
		  PASSWORD=#password#
		WHERE username = #username#
	</update>
	<delete id="deleteUser" parameterClass="java.lang.String">
		update user set status='INACT' where username=#username#;
	</delete>
	
	<update id="resetPassword" parameterClass="UserEntity">
		<![CDATA[ 
		UPDATE user 
		SET  
		  PASSWORD=#password#
		WHERE username = #username#
		]]>
	</update>
	
	<select id="getEmailRecievers" resultClass="java.lang.String">
		SELECT 
			EMAIL
		FROM 
			user
		where isMailReciever='Y'
	</select>

</sqlMap>
  -->